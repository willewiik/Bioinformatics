---
title: "LAB 2 Bioinformatics"
author:
- Hugo Morvan
- William Wiik
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
    fig_caption: true
    number_sections: true
  html_document:
    df_print: paged
  word_document: default
geometry: top=100pt,bottom=100pt,left=68pt,right=66pt
header-includes:
- \usepackage{float}
- \usepackage{longtable}
- \usepackage{caption}
- \usepackage{fancyhdr}
- \usepackage{titling}
- \renewcommand{\headrulewidth}{0pt}
- \renewcommand{\and}{\\}
- \pretitle{\centering\vspace{0cm}{732A51 Bioinformatics \par}\vspace{5cm}\Huge\textbf}
- \posttitle{\vspace{1cm}\large\textbf{}\par}
- \preauthor{\centering\vspace{4cm}\normalsize}
- \postauthor{\par\vspace{2cm}}
- \predate{\centering{\normalsize STIMA \\ Department of Computer and Information
  Science \\ Link√∂pings universitet \par}}
- \postdate{\par\vspace{0cm}}
- \raggedbottom
---


<!-- page number pos -->
\fancyhf{}
\fancyfoot[C]{\thepage}
\pagestyle{fancy}

<!-- no page nr on first page  -->
\pagenumbering{gobble}

<!-- Anger sidbrytning -->
\clearpage

<!-- creating the table of contents -->
\setcounter{tocdepth}{3}
\tableofcontents

<!-- new page -->
\clearpage

<!-- starting the count on 1 after the contents -->
\pagenumbering{arabic}
\setcounter{page}{1}

```{r, include = FALSE,message=FALSE}
set.seed(12345)
library(dplyr)
library(ape)
library(seqinr)
```


# Question 1

In this exercise you will perform statistical analysis of three nucleotide data sets. First download
the sequences from GenBank and save them in a fasta le. For this use the provided R script,
732A51_BioinformaticsHT2023_Lab02_GenBankGetCode.R. This is a dataset of the RAG1 gene
sequences from 33 lizard species. You are encouraged to read in detail the references in the script
as they indicate many useful tools. Explore the dataset using the tools provided by the `ape` and
`seqinr` packages. Take note of the lengths of all the sequences and the base composition.


```{r}

## Gene bank accession numbers taken from http://www.jcsantosresearch.org/Class_2014_Spring_Comparative/pdf/week_2/Jan_13_15_2015_GenBank_part_2.pdf
lizards_accession_numbers <- c("JF806202", "HM161150", "FJ356743", "JF806205", 
                               "JQ073190", "GU457971", "FJ356741", "JF806207",
                               "JF806210", "AY662592", "AY662591", "FJ356748",       
                               "JN112660", "AY662594", "JN112661", "HQ876437", 
                               "HQ876434", "AY662590", "FJ356740", "JF806214", 
                               "JQ073188", "FJ356749", "JQ073189", "JF806216", 
                               "AY662598", "JN112653", "JF806204", "FJ356747", 
                               "FJ356744", "HQ876440", "JN112651", "JF806215",
                               "JF806209") 
lizards_sequences<-ape::read.GenBank(lizards_accession_numbers)
print(lizards_sequences)
ape::write.dna(lizards_sequences, file ="lizard_seqs.fasta", format = "fasta",
               append =FALSE, nbcol = 6, colsep = " ", colw = 10)


```


## Question 1.1

Simulate an artificial DNA sequence dataset. It should contain 33 sequence. The lengths of
the sequences should be the same as in the lizard dataset, i.e. for each real sequence simulate
an arti cial one. The simulation rule is as follows, each nucleotide is to be independently and
randomly drawn from the distribution given by the base composition (frequencies) in the true
lizard sequences. Save your dataset in a fasta format file. Remember to give unique names to
your sequences. Report on the base composition in your simulated data.

**Answer:**

```{r}

true_base_composition <- c(0.312, 0.205, 0.231, 0.252) # a c g t

# Length of each real sequence
sequence_lengths <- sapply(lizards_sequences, length)

# Simulating DNA
sim_sequences <- lapply(sequence_lengths, function(length) {
   rDNAbin(n = length, base.freq = true_base_composition)[[1]]
})

names(sim_sequences) <- paste0("seq_",1:33)

sim_sequences <- structure(sim_sequences, class = "DNAbin")

ape::write.dna(sim_sequences, file = "sim_lizard_seqs.fasta", 
               format = "fasta", append = FALSE, nbcol = 6, colsep = " ", colw = 10)

sim_lizard_seqs <- read.FASTA("sim_lizard_seqs.fasta")
print(sim_lizard_seqs)

```



a: 31.2%
c: 20.3%
g: 23.0%
t: 25.5%

We obtain almost the same base composition as the true base composition for lizard sequences.


## Question 1.2 *




```{r}

```




\newpage


# Question 2


## Question 2.1

Report some basic statistics on each sequence dataset: individual base composition, $GC$ content,
$CG$, $AT$ content. Also translate your sequences into protein sequences (see Lab 1) and report
on the amino acid composition. In your simulated sequences, how many times did you observe
a stop codon inside your sequence? Does this occur in your true sequences? Comment.

```{r}

```


## Question 2.2*

```{r}

```


## Question 2.3

Align your sequences using software of your choice (a starter for R: https://stackoverflow.com/questions/4497747/how-to-perform-basic-multiple-sequence-alignments-in-r, you
can also look what `Biopython`, `BioPerl` offer, use the `Clustal` family of programs or something
else of your choice).
Choose a distance measure between sequences, calculate for each alignment the distances
between all pairs of sequences. Then, plot heatmaps visualizing the distances. Comment on
what you can observe

```{r}

```





# Question 3


## Question 3.1

Construct (using algorithm and software of your choice) phylogenetic trees from the three mul
tiple alignments (or distance matrices) done in Question 2.3. You might want to look at the
functions o ered by `ape`, `phangorn` (https://cran.r-project.org/web/packages/phangorn/vignettes/Trees.pdf) or go for some completely di erent software. Plot the inferred trees. Are
the two based on the simulated data similar to expected?
Perform a phylogenetic bootstrap analysis and report the bootstrap support for the individual
clades, you can look at `ape::boot.phylo()`.

```{r}

```



## Question 3.2*

```{r}

```




